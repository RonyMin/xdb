CREATE TABLE 1_1_1__1_1 (L_ORDERKEY INTEGER, L_PARTKEY INTEGER, L_SUPPKEY INTEGER, L_LINENUMBER INTEGER, L_QUANTITY DECIMAL(65,30), L_EXTENDEDPRICE DECIMAL(65,30), L_DISCOUNT DECIMAL(65,30), L_TAX DECIMAL(65,30), L_RETURNFLAG VARCHAR(255), L_LINESTATUS VARCHAR(255), L_SHIPDATE DATE, L_COMMITDATE DATE, L_RECEIPTDATE DATE, L_SHIPINSTRUCT VARCHAR(255), L_SHIPMODE VARCHAR(255), L_COMMENT VARCHAR(255)) ENGINE=FEDERATED CONNECTION='mysql://xroot:xroot@127.0.0.1/tpch_s01/LINEITEM';
CREATE TABLE 1_1_1__1_2 (O_SHIPPRIORITY INTEGER, O_COMMENT VARCHAR(255), O_ORDERKEY INTEGER, O_ORDERSTATUS VARCHAR(255), O_CUSTKEY INTEGER, O_ORDERDATE DATE, O_TOTALPRICE DECIMAL(65,30), O_CLERK VARCHAR(255), O_ORDERPRIORITY VARCHAR(255)) ENGINE=FEDERATED CONNECTION='mysql://xroot:xroot@127.0.0.1/tpch_s01/ORDERS';
CREATE TABLE 1_1_1__1_4 (C_CUSTKEY INTEGER, C_ADDRESS VARCHAR(255), C_NAME VARCHAR(255), C_PHONE VARCHAR(255), C_NATIONKEY INTEGER, C_MKTSEGMENT VARCHAR(255), C_ACCTBAL DECIMAL(65,30), C_COMMENT VARCHAR(255)) ENGINE=FEDERATED CONNECTION='mysql://xroot:xroot@127.0.0.1/tpch_s01/CUSTOMER';


EXPLAIN SELECT 1_5.LINEITEM_L_ORDERKEY AS _INT_ALIAS_1, SUM((1_5.LINEITEM_L_EXTENDEDPRICE*(1-1_5.LINEITEM_L_DISCOUNT))) AS _INT_ALIAS_2, 1_5.ORDERS_O_ORDERDATE AS _INT_ALIAS_3, 1_5.ORDERS_O_SHIPPRIORITY AS _INT_ALIAS_4 FROM (SELECT 1_3.LINEITEM_L_ORDERKEY AS LINEITEM_L_ORDERKEY, 1_3.LINEITEM_L_PARTKEY AS LINEITEM_L_PARTKEY, 1_3.LINEITEM_L_SUPPKEY AS LINEITEM_L_SUPPKEY, 1_3.LINEITEM_L_LINENUMBER AS LINEITEM_L_LINENUMBER, 1_3.LINEITEM_L_QUANTITY AS LINEITEM_L_QUANTITY, 1_3.LINEITEM_L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, 1_3.LINEITEM_L_DISCOUNT AS LINEITEM_L_DISCOUNT, 1_3.LINEITEM_L_TAX AS LINEITEM_L_TAX, 1_3.LINEITEM_L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, 1_3.LINEITEM_L_LINESTATUS AS LINEITEM_L_LINESTATUS, 1_3.LINEITEM_L_SHIPDATE AS LINEITEM_L_SHIPDATE, 1_3.LINEITEM_L_COMMITDATE AS LINEITEM_L_COMMITDATE, 1_3.LINEITEM_L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, 1_3.LINEITEM_L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, 1_3.LINEITEM_L_SHIPMODE AS LINEITEM_L_SHIPMODE, 1_3.LINEITEM_L_COMMENT AS LINEITEM_L_COMMENT, 1_3.ORDERS_O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, 1_3.ORDERS_O_COMMENT AS ORDERS_O_COMMENT, 1_3.ORDERS_O_ORDERKEY AS ORDERS_O_ORDERKEY, 1_3.ORDERS_O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, 1_3.ORDERS_O_CUSTKEY AS ORDERS_O_CUSTKEY, 1_3.ORDERS_O_ORDERDATE AS ORDERS_O_ORDERDATE, 1_3.ORDERS_O_TOTALPRICE AS ORDERS_O_TOTALPRICE, 1_3.ORDERS_O_CLERK AS ORDERS_O_CLERK, 1_3.ORDERS_O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY,1_8.CUSTOMER_C_CUSTKEY AS CUSTOMER_C_CUSTKEY, 1_8.CUSTOMER_C_ADDRESS AS CUSTOMER_C_ADDRESS, 1_8.CUSTOMER_C_NAME AS CUSTOMER_C_NAME, 1_8.CUSTOMER_C_PHONE AS CUSTOMER_C_PHONE, 1_8.CUSTOMER_C_NATIONKEY AS CUSTOMER_C_NATIONKEY, 1_8.CUSTOMER_C_MKTSEGMENT AS CUSTOMER_C_MKTSEGMENT, 1_8.CUSTOMER_C_ACCTBAL AS CUSTOMER_C_ACCTBAL, 1_8.CUSTOMER_C_COMMENT AS CUSTOMER_C_COMMENT FROM (SELECT 1_7.LINEITEM_L_ORDERKEY AS LINEITEM_L_ORDERKEY, 1_7.LINEITEM_L_PARTKEY AS LINEITEM_L_PARTKEY, 1_7.LINEITEM_L_SUPPKEY AS LINEITEM_L_SUPPKEY, 1_7.LINEITEM_L_LINENUMBER AS LINEITEM_L_LINENUMBER, 1_7.LINEITEM_L_QUANTITY AS LINEITEM_L_QUANTITY, 1_7.LINEITEM_L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, 1_7.LINEITEM_L_DISCOUNT AS LINEITEM_L_DISCOUNT, 1_7.LINEITEM_L_TAX AS LINEITEM_L_TAX, 1_7.LINEITEM_L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, 1_7.LINEITEM_L_LINESTATUS AS LINEITEM_L_LINESTATUS, 1_7.LINEITEM_L_SHIPDATE AS LINEITEM_L_SHIPDATE, 1_7.LINEITEM_L_COMMITDATE AS LINEITEM_L_COMMITDATE, 1_7.LINEITEM_L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, 1_7.LINEITEM_L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, 1_7.LINEITEM_L_SHIPMODE AS LINEITEM_L_SHIPMODE, 1_7.LINEITEM_L_COMMENT AS LINEITEM_L_COMMENT,1_6.ORDERS_O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, 1_6.ORDERS_O_COMMENT AS ORDERS_O_COMMENT, 1_6.ORDERS_O_ORDERKEY AS ORDERS_O_ORDERKEY, 1_6.ORDERS_O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, 1_6.ORDERS_O_CUSTKEY AS ORDERS_O_CUSTKEY, 1_6.ORDERS_O_ORDERDATE AS ORDERS_O_ORDERDATE, 1_6.ORDERS_O_TOTALPRICE AS ORDERS_O_TOTALPRICE, 1_6.ORDERS_O_CLERK AS ORDERS_O_CLERK, 1_6.ORDERS_O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY FROM (SELECT 1_1.LINEITEM_L_ORDERKEY AS LINEITEM_L_ORDERKEY, 1_1.LINEITEM_L_PARTKEY AS LINEITEM_L_PARTKEY, 1_1.LINEITEM_L_SUPPKEY AS LINEITEM_L_SUPPKEY, 1_1.LINEITEM_L_LINENUMBER AS LINEITEM_L_LINENUMBER, 1_1.LINEITEM_L_QUANTITY AS LINEITEM_L_QUANTITY, 1_1.LINEITEM_L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, 1_1.LINEITEM_L_DISCOUNT AS LINEITEM_L_DISCOUNT, 1_1.LINEITEM_L_TAX AS LINEITEM_L_TAX, 1_1.LINEITEM_L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, 1_1.LINEITEM_L_LINESTATUS AS LINEITEM_L_LINESTATUS, 1_1.LINEITEM_L_SHIPDATE AS LINEITEM_L_SHIPDATE, 1_1.LINEITEM_L_COMMITDATE AS LINEITEM_L_COMMITDATE, 1_1.LINEITEM_L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, 1_1.LINEITEM_L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, 1_1.LINEITEM_L_SHIPMODE AS LINEITEM_L_SHIPMODE, 1_1.LINEITEM_L_COMMENT AS LINEITEM_L_COMMENT FROM (SELECT _1_1.L_ORDERKEY AS LINEITEM_L_ORDERKEY, _1_1.L_PARTKEY AS LINEITEM_L_PARTKEY, _1_1.L_SUPPKEY AS LINEITEM_L_SUPPKEY, _1_1.L_LINENUMBER AS LINEITEM_L_LINENUMBER, _1_1.L_QUANTITY AS LINEITEM_L_QUANTITY, _1_1.L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, _1_1.L_DISCOUNT AS LINEITEM_L_DISCOUNT, _1_1.L_TAX AS LINEITEM_L_TAX, _1_1.L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, _1_1.L_LINESTATUS AS LINEITEM_L_LINESTATUS, _1_1.L_SHIPDATE AS LINEITEM_L_SHIPDATE, _1_1.L_COMMITDATE AS LINEITEM_L_COMMITDATE, _1_1.L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, _1_1.L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, _1_1.L_SHIPMODE AS LINEITEM_L_SHIPMODE, _1_1.L_COMMENT AS LINEITEM_L_COMMENT FROM 1_1_1__1_1 AS _1_1) AS 1_1 WHERE (1_1.LINEITEM_L_SHIPDATE>DATE '1995-03-15')) AS 1_7 INNER JOIN (SELECT 1_2.ORDERS_O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, 1_2.ORDERS_O_COMMENT AS ORDERS_O_COMMENT, 1_2.ORDERS_O_ORDERKEY AS ORDERS_O_ORDERKEY, 1_2.ORDERS_O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, 1_2.ORDERS_O_CUSTKEY AS ORDERS_O_CUSTKEY, 1_2.ORDERS_O_ORDERDATE AS ORDERS_O_ORDERDATE, 1_2.ORDERS_O_TOTALPRICE AS ORDERS_O_TOTALPRICE, 1_2.ORDERS_O_CLERK AS ORDERS_O_CLERK, 1_2.ORDERS_O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY FROM (SELECT _1_2.O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, _1_2.O_COMMENT AS ORDERS_O_COMMENT, _1_2.O_ORDERKEY AS ORDERS_O_ORDERKEY, _1_2.O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, _1_2.O_CUSTKEY AS ORDERS_O_CUSTKEY, _1_2.O_ORDERDATE AS ORDERS_O_ORDERDATE, _1_2.O_TOTALPRICE AS ORDERS_O_TOTALPRICE, _1_2.O_CLERK AS ORDERS_O_CLERK, _1_2.O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY FROM 1_1_1__1_2 AS _1_2) AS 1_2 WHERE (1_2.ORDERS_O_ORDERDATE<DATE '1995-03-15')) AS 1_6 ON 1_7.LINEITEM_L_ORDERKEY = 1_6.ORDERS_O_ORDERKEY) AS 1_3 INNER JOIN (SELECT 1_4.CUSTOMER_C_CUSTKEY AS CUSTOMER_C_CUSTKEY, 1_4.CUSTOMER_C_ADDRESS AS CUSTOMER_C_ADDRESS, 1_4.CUSTOMER_C_NAME AS CUSTOMER_C_NAME, 1_4.CUSTOMER_C_PHONE AS CUSTOMER_C_PHONE, 1_4.CUSTOMER_C_NATIONKEY AS CUSTOMER_C_NATIONKEY, 1_4.CUSTOMER_C_MKTSEGMENT AS CUSTOMER_C_MKTSEGMENT, 1_4.CUSTOMER_C_ACCTBAL AS CUSTOMER_C_ACCTBAL, 1_4.CUSTOMER_C_COMMENT AS CUSTOMER_C_COMMENT FROM (SELECT _1_4.C_CUSTKEY AS CUSTOMER_C_CUSTKEY, _1_4.C_ADDRESS AS CUSTOMER_C_ADDRESS, _1_4.C_NAME AS CUSTOMER_C_NAME, _1_4.C_PHONE AS CUSTOMER_C_PHONE, _1_4.C_NATIONKEY AS CUSTOMER_C_NATIONKEY, _1_4.C_MKTSEGMENT AS CUSTOMER_C_MKTSEGMENT, _1_4.C_ACCTBAL AS CUSTOMER_C_ACCTBAL, _1_4.C_COMMENT AS CUSTOMER_C_COMMENT FROM 1_1_1__1_4 AS _1_4) AS 1_4 WHERE (1_4.CUSTOMER_C_MKTSEGMENT='BUILDING')) AS 1_8 ON 1_3.ORDERS_O_CUSTKEY = 1_8.CUSTOMER_C_CUSTKEY) AS 1_5 GROUP BY 1_5.LINEITEM_L_ORDERKEY, 1_5.ORDERS_O_ORDERDATE, 1_5.ORDERS_O_SHIPPRIORITY;


EXPLAIN SELECT 1_5.LINEITEM_L_ORDERKEY AS _INT_ALIAS_1, SUM((1_5.LINEITEM_L_EXTENDEDPRICE*(1-1_5.LINEITEM_L_DISCOUNT))) AS _INT_ALIAS_2, 1_5.ORDERS_O_ORDERDATE AS _INT_ALIAS_3, 1_5.ORDERS_O_SHIPPRIORITY AS _INT_ALIAS_4 FROM (SELECT 1_3.LINEITEM_L_ORDERKEY AS LINEITEM_L_ORDERKEY, 1_3.LINEITEM_L_PARTKEY AS LINEITEM_L_PARTKEY, 1_3.LINEITEM_L_SUPPKEY AS LINEITEM_L_SUPPKEY, 1_3.LINEITEM_L_LINENUMBER AS LINEITEM_L_LINENUMBER, 1_3.LINEITEM_L_QUANTITY AS LINEITEM_L_QUANTITY, 1_3.LINEITEM_L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, 1_3.LINEITEM_L_DISCOUNT AS LINEITEM_L_DISCOUNT, 1_3.LINEITEM_L_TAX AS LINEITEM_L_TAX, 1_3.LINEITEM_L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, 1_3.LINEITEM_L_LINESTATUS AS LINEITEM_L_LINESTATUS, 1_3.LINEITEM_L_SHIPDATE AS LINEITEM_L_SHIPDATE, 1_3.LINEITEM_L_COMMITDATE AS LINEITEM_L_COMMITDATE, 1_3.LINEITEM_L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, 1_3.LINEITEM_L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, 1_3.LINEITEM_L_SHIPMODE AS LINEITEM_L_SHIPMODE, 1_3.LINEITEM_L_COMMENT AS LINEITEM_L_COMMENT, 1_3.ORDERS_O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, 1_3.ORDERS_O_COMMENT AS ORDERS_O_COMMENT, 1_3.ORDERS_O_ORDERKEY AS ORDERS_O_ORDERKEY, 1_3.ORDERS_O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, 1_3.ORDERS_O_CUSTKEY AS ORDERS_O_CUSTKEY, 1_3.ORDERS_O_ORDERDATE AS ORDERS_O_ORDERDATE, 1_3.ORDERS_O_TOTALPRICE AS ORDERS_O_TOTALPRICE, 1_3.ORDERS_O_CLERK AS ORDERS_O_CLERK, 1_3.ORDERS_O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY,1_8.CUSTOMER_C_CUSTKEY AS CUSTOMER_C_CUSTKEY, 1_8.CUSTOMER_C_ADDRESS AS CUSTOMER_C_ADDRESS, 1_8.CUSTOMER_C_NAME AS CUSTOMER_C_NAME, 1_8.CUSTOMER_C_PHONE AS CUSTOMER_C_PHONE, 1_8.CUSTOMER_C_NATIONKEY AS CUSTOMER_C_NATIONKEY, 1_8.CUSTOMER_C_MKTSEGMENT AS CUSTOMER_C_MKTSEGMENT, 1_8.CUSTOMER_C_ACCTBAL AS CUSTOMER_C_ACCTBAL, 1_8.CUSTOMER_C_COMMENT AS CUSTOMER_C_COMMENT FROM (SELECT 1_7.LINEITEM_L_ORDERKEY AS LINEITEM_L_ORDERKEY, 1_7.LINEITEM_L_PARTKEY AS LINEITEM_L_PARTKEY, 1_7.LINEITEM_L_SUPPKEY AS LINEITEM_L_SUPPKEY, 1_7.LINEITEM_L_LINENUMBER AS LINEITEM_L_LINENUMBER, 1_7.LINEITEM_L_QUANTITY AS LINEITEM_L_QUANTITY, 1_7.LINEITEM_L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, 1_7.LINEITEM_L_DISCOUNT AS LINEITEM_L_DISCOUNT, 1_7.LINEITEM_L_TAX AS LINEITEM_L_TAX, 1_7.LINEITEM_L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, 1_7.LINEITEM_L_LINESTATUS AS LINEITEM_L_LINESTATUS, 1_7.LINEITEM_L_SHIPDATE AS LINEITEM_L_SHIPDATE, 1_7.LINEITEM_L_COMMITDATE AS LINEITEM_L_COMMITDATE, 1_7.LINEITEM_L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, 1_7.LINEITEM_L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, 1_7.LINEITEM_L_SHIPMODE AS LINEITEM_L_SHIPMODE, 1_7.LINEITEM_L_COMMENT AS LINEITEM_L_COMMENT,1_6.ORDERS_O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, 1_6.ORDERS_O_COMMENT AS ORDERS_O_COMMENT, 1_6.ORDERS_O_ORDERKEY AS ORDERS_O_ORDERKEY, 1_6.ORDERS_O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, 1_6.ORDERS_O_CUSTKEY AS ORDERS_O_CUSTKEY, 1_6.ORDERS_O_ORDERDATE AS ORDERS_O_ORDERDATE, 1_6.ORDERS_O_TOTALPRICE AS ORDERS_O_TOTALPRICE, 1_6.ORDERS_O_CLERK AS ORDERS_O_CLERK, 1_6.ORDERS_O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY FROM (SELECT 1_1.LINEITEM_L_ORDERKEY AS LINEITEM_L_ORDERKEY, 1_1.LINEITEM_L_PARTKEY AS LINEITEM_L_PARTKEY, 1_1.LINEITEM_L_SUPPKEY AS LINEITEM_L_SUPPKEY, 1_1.LINEITEM_L_LINENUMBER AS LINEITEM_L_LINENUMBER, 1_1.LINEITEM_L_QUANTITY AS LINEITEM_L_QUANTITY, 1_1.LINEITEM_L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, 1_1.LINEITEM_L_DISCOUNT AS LINEITEM_L_DISCOUNT, 1_1.LINEITEM_L_TAX AS LINEITEM_L_TAX, 1_1.LINEITEM_L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, 1_1.LINEITEM_L_LINESTATUS AS LINEITEM_L_LINESTATUS, 1_1.LINEITEM_L_SHIPDATE AS LINEITEM_L_SHIPDATE, 1_1.LINEITEM_L_COMMITDATE AS LINEITEM_L_COMMITDATE, 1_1.LINEITEM_L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, 1_1.LINEITEM_L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, 1_1.LINEITEM_L_SHIPMODE AS LINEITEM_L_SHIPMODE, 1_1.LINEITEM_L_COMMENT AS LINEITEM_L_COMMENT FROM (SELECT _1_1.L_ORDERKEY AS LINEITEM_L_ORDERKEY, _1_1.L_PARTKEY AS LINEITEM_L_PARTKEY, _1_1.L_SUPPKEY AS LINEITEM_L_SUPPKEY, _1_1.L_LINENUMBER AS LINEITEM_L_LINENUMBER, _1_1.L_QUANTITY AS LINEITEM_L_QUANTITY, _1_1.L_EXTENDEDPRICE AS LINEITEM_L_EXTENDEDPRICE, _1_1.L_DISCOUNT AS LINEITEM_L_DISCOUNT, _1_1.L_TAX AS LINEITEM_L_TAX, _1_1.L_RETURNFLAG AS LINEITEM_L_RETURNFLAG, _1_1.L_LINESTATUS AS LINEITEM_L_LINESTATUS, _1_1.L_SHIPDATE AS LINEITEM_L_SHIPDATE, _1_1.L_COMMITDATE AS LINEITEM_L_COMMITDATE, _1_1.L_RECEIPTDATE AS LINEITEM_L_RECEIPTDATE, _1_1.L_SHIPINSTRUCT AS LINEITEM_L_SHIPINSTRUCT, _1_1.L_SHIPMODE AS LINEITEM_L_SHIPMODE, _1_1.L_COMMENT AS LINEITEM_L_COMMENT FROM tpch_s01.LINEITEM AS _1_1) AS 1_1 WHERE (1_1.LINEITEM_L_SHIPDATE>DATE '1995-03-15')) AS 1_7 INNER JOIN (SELECT 1_2.ORDERS_O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, 1_2.ORDERS_O_COMMENT AS ORDERS_O_COMMENT, 1_2.ORDERS_O_ORDERKEY AS ORDERS_O_ORDERKEY, 1_2.ORDERS_O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, 1_2.ORDERS_O_CUSTKEY AS ORDERS_O_CUSTKEY, 1_2.ORDERS_O_ORDERDATE AS ORDERS_O_ORDERDATE, 1_2.ORDERS_O_TOTALPRICE AS ORDERS_O_TOTALPRICE, 1_2.ORDERS_O_CLERK AS ORDERS_O_CLERK, 1_2.ORDERS_O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY FROM (SELECT _1_2.O_SHIPPRIORITY AS ORDERS_O_SHIPPRIORITY, _1_2.O_COMMENT AS ORDERS_O_COMMENT, _1_2.O_ORDERKEY AS ORDERS_O_ORDERKEY, _1_2.O_ORDERSTATUS AS ORDERS_O_ORDERSTATUS, _1_2.O_CUSTKEY AS ORDERS_O_CUSTKEY, _1_2.O_ORDERDATE AS ORDERS_O_ORDERDATE, _1_2.O_TOTALPRICE AS ORDERS_O_TOTALPRICE, _1_2.O_CLERK AS ORDERS_O_CLERK, _1_2.O_ORDERPRIORITY AS ORDERS_O_ORDERPRIORITY FROM tpch_s01.ORDERS AS _1_2) AS 1_2 WHERE (1_2.ORDERS_O_ORDERDATE<DATE '1995-03-15')) AS 1_6 ON 1_7.LINEITEM_L_ORDERKEY = 1_6.ORDERS_O_ORDERKEY) AS 1_3 INNER JOIN (SELECT 1_4.CUSTOMER_C_CUSTKEY AS CUSTOMER_C_CUSTKEY, 1_4.CUSTOMER_C_ADDRESS AS CUSTOMER_C_ADDRESS, 1_4.CUSTOMER_C_NAME AS CUSTOMER_C_NAME, 1_4.CUSTOMER_C_PHONE AS CUSTOMER_C_PHONE, 1_4.CUSTOMER_C_NATIONKEY AS CUSTOMER_C_NATIONKEY, 1_4.CUSTOMER_C_MKTSEGMENT AS CUSTOMER_C_MKTSEGMENT, 1_4.CUSTOMER_C_ACCTBAL AS CUSTOMER_C_ACCTBAL, 1_4.CUSTOMER_C_COMMENT AS CUSTOMER_C_COMMENT FROM (SELECT _1_4.C_CUSTKEY AS CUSTOMER_C_CUSTKEY, _1_4.C_ADDRESS AS CUSTOMER_C_ADDRESS, _1_4.C_NAME AS CUSTOMER_C_NAME, _1_4.C_PHONE AS CUSTOMER_C_PHONE, _1_4.C_NATIONKEY AS CUSTOMER_C_NATIONKEY, _1_4.C_MKTSEGMENT AS CUSTOMER_C_MKTSEGMENT, _1_4.C_ACCTBAL AS CUSTOMER_C_ACCTBAL, _1_4.C_COMMENT AS CUSTOMER_C_COMMENT FROM tpch_s01.CUSTOMER AS _1_4) AS 1_4 WHERE (1_4.CUSTOMER_C_MKTSEGMENT='BUILDING')) AS 1_8 ON 1_3.ORDERS_O_CUSTKEY = 1_8.CUSTOMER_C_CUSTKEY) AS 1_5 GROUP BY 1_5.LINEITEM_L_ORDERKEY, 1_5.ORDERS_O_ORDERDATE, 1_5.ORDERS_O_SHIPPRIORITY;


EXPLAIN select l_orderkey,
sum(l_extendedprice*(1-l_discount)) as revenue, 
o_orderdate, 
o_shippriority
from 
1_1_1__1_4 as customer, 
tpch_s01.orders, 
1_1_1__1_1 as lineitem 
where c_mktsegment = 'BUILDING' and 
c_custkey = o_custkey and 
l_orderkey = o_orderkey and 
o_orderdate < date '1995-03-15' and 
l_shipdate > date '1995-03-15' 
group by l_orderkey, o_orderdate, o_shippriority;


EXPLAIN select l_orderkey,
sum(l_extendedprice*(1-l_discount)) as revenue, 
o_orderdate, 
o_shippriority
from 
tpch_s01.customer, 
tpch_s01.orders, 
tpch_s01.lineitem 
where c_mktsegment = 'BUILDING' and 
c_custkey = o_custkey and 
l_orderkey = o_orderkey and 
o_orderdate < date '1995-03-15' and 
l_shipdate > date '1995-03-15' 
group by l_orderkey, o_orderdate, o_shippriority;